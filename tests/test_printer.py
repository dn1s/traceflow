import unittest
from traceflow import printer


class TestPrinter(unittest.TestCase):
    traces = {
        1: {
            1: "136.243.212.25",
            2: "213.239.229.57",
            3: "213.239.203.153",
            4: "62.69.146.42",
            5: "1.1.1.1",
        },
        2: {
            1: "136.243.212.25",
            2: "213.239.229.57",
            3: "213.239.203.153",
            4: "62.69.146.42",
            5: "1.1.1.1",
        },
        3: {
            1: "136.243.212.25",
            2: "213.239.229.57",
            3: "213.239.203.153",
            4: "62.69.146.42",
            5: "1.1.1.1",
        },
        4: {
            1: "136.243.212.25",
            2: "213.239.229.61",
            3: "213.239.229.77",
            4: "62.69.146.42",
            5: "1.1.1.1",
        },
    }

    def test___build_nodes(self):
        json_traces = printer._build_nodes(self.traces)
        self.assertEqual(
            json_traces,
            '{"nodes": [{"id": "136.243.212.25", "label": "136.243.212.25"}, {"id": "213.239.229.57", "label": "213.239.229.57"}, {"id": "213.239.203.153", "label": "213.239.203.153"}, {"id": "62.69.146.42", "label": "62.69.146.42"}, {"id": "1.1.1.1", "label": "1.1.1.1"}, {"id": "213.239.229.61", "label": "213.239.229.61"}, {"id": "213.239.229.77", "label": "213.239.229.77"}], "links": [{"from": "136.243.212.25", "to": "213.239.229.57"}, {"from": "213.239.229.57", "to": "213.239.203.153"}, {"from": "213.239.203.153", "to": "62.69.146.42"}, {"from": "62.69.146.42", "to": "1.1.1.1"}, {"from": "136.243.212.25", "to": "213.239.229.57"}, {"from": "213.239.229.57", "to": "213.239.203.153"}, {"from": "213.239.203.153", "to": "62.69.146.42"}, {"from": "62.69.146.42", "to": "1.1.1.1"}, {"from": "136.243.212.25", "to": "213.239.229.57"}, {"from": "213.239.229.57", "to": "213.239.203.153"}, {"from": "213.239.203.153", "to": "62.69.146.42"}, {"from": "62.69.146.42", "to": "1.1.1.1"}, {"from": "136.243.212.25", "to": "213.239.229.61"}, {"from": "213.239.229.61", "to": "213.239.229.77"}, {"from": "213.239.229.77", "to": "62.69.146.42"}, {"from": "62.69.146.42", "to": "1.1.1.1"}]}',
        )


if __name__ == "__main__":
    unittest.main()
